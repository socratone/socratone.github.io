<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.5/dist/web/static/pretendard.css"/><link rel="preload" href="/_next/static/css/106dc65b90983e57.css" as="style"/><link rel="stylesheet" href="/_next/static/css/106dc65b90983e57.css" data-n-g=""/><link rel="preload" href="/_next/static/css/bab74c2f662373c3.css" as="style"/><link rel="stylesheet" href="/_next/static/css/bab74c2f662373c3.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-0b5d8249fb15f5f3.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-e6056826ef800c0e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-7aefdbe4b5e3c469.js" defer=""></script><script src="/_next/static/chunks/pages/blogs/%5Bname%5D-a29769161c395bfe.js" defer=""></script><script src="/_next/static/mO96hVcFmN38CsCcAxckd/_buildManifest.js" defer=""></script><script src="/_next/static/mO96hVcFmN38CsCcAxckd/_ssgManifest.js" defer=""></script></head><body><div id="__next"><style data-emotion="css 1wcvzvn">.css-1wcvzvn{position:-webkit-sticky;position:sticky;top:0;z-index:10;background-color:#fff;border-bottom:1px solid;border-color:rgba(0, 0, 0, 0.12);}</style><header class="MuiBox-root css-1wcvzvn"><style data-emotion="css 1qsxih2">.css-1qsxih2{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;}@media (min-width:600px){.css-1qsxih2{padding-left:24px;padding-right:24px;}}@media (min-width:1200px){.css-1qsxih2{max-width:1200px;}}</style><div class="MuiContainer-root MuiContainer-maxWidthLg css-1qsxih2"><style data-emotion="css eedvsh">.css-eedvsh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;height:50px;}.css-eedvsh>:not(style)+:not(style){margin:0;margin-left:16px;}</style><div class="MuiStack-root css-eedvsh"><a href="/"><style data-emotion="css 1s7du97">.css-1s7du97{margin:0;font-family:Pretendard,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-weight:400;font-size:1rem;line-height:1.5;color:rgba(0, 0, 0, 0.87);cursor:pointer;height:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><p class="MuiTypography-root MuiTypography-body1 css-1s7du97">Home</p></a><a href="/blogs/attendance-detail"><p class="MuiTypography-root MuiTypography-body1 css-1s7du97">Blog</p></a></div></div></header><style data-emotion="css 1v3gb9h">.css-1v3gb9h{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;padding-top:16px;padding-bottom:16px;}@media (min-width:600px){.css-1v3gb9h{padding-left:24px;padding-right:24px;}}@media (min-width:1200px){.css-1v3gb9h{max-width:1200px;}}</style><div class="MuiContainer-root MuiContainer-maxWidthLg css-1v3gb9h"><section class="markdown-body"><h1>출석부 개발</h1>
<p>admin 개발은 이제 능숙하게 할 수 있고 이번에 출석부 admin 페이지를 새로 만들면서<br>
어떻게 코드를 작성했는지 정리해 두면 후배 개발자나 평가자들에게 도움이 될 것이라 생각한다.<br>
많은 페이지 중 출석부 상세 페이지 코드에 대해서 다루겠다.<br>
여러 출석부를 생성할 수 있고 출석부 리스트 페이지에서 각 아이템 링크로 접근할 수 있는 페이지다.<br>
모든 코드는 제일 아래쪽에서 볼 수 있다.<br>
위에서부터 아래로 내려가며 하나씩 설명해보겠다.</p>
<h2>Hooks 순서</h2>
<h3>Global state</h3>
<p>AdminAttendanceDetail 컴포넌트 내부의 첫 번째 줄을 보면<br>
제일 먼저 어쩔 수 없이 넣어야 하는 hook을 두었다.</p>
<ul>
<li>react router 5의 history를 쓰기 위해서 useHistory()</li>
<li>다국어 지원을 위한 react intl의 intl을 쓰기 위해서 useIntl()</li>
<li>api state를 관리해주는 tanstack qeury(react query)의 queryClient를 쓰기 위해서 useQueryClient()</li>
<li>url의 query parameter를 가져오기 위해서 useParams()</li>
</ul>
<pre><code>const history = useHistory();
const intl = useIntl();
const queryClient = useQueryClient();
const { attendanceBookId } = useParams&#x3C;{ attendanceBookId: string }>();
</code></pre>
<p>마치 import 해오듯이 컴포넌트에서 필요한 variable을 가져오는 코드는 제일 위쪽에 두는 게 좋아보인다.<br>
다음으로 redux나 recoil 등의 global state를 두지만 여기서는 global state를 활용하지 않는다.<br>
사실 react query가 등장한 이후로 global state를 사용할일이 별로 없어진듯하다.<br>
만약 넣는다면 <a href="https://redux-toolkit.js.org/tutorials/typescript#use-typed-hooks-in-components">아래와 같은 코드</a>를 넣었을 테다.</p>
<pre><code>const count = useAppSelector((state) => state.counter.value);
</code></pre>
<h3>Local State</h3>
<p>다음으로는 local state가 온다.</p>
<p>동료 개발자가 구현한 form 모달을 열고 닫을 수 있는 open state를 뒀다.</p>
<pre><code>const [isAttendanceBookEditModalOpened, setIsAttendanceBookEditModalOpened] =
  React.useState(false);
</code></pre>
<p>출석부 상세 페이지에는 출석부 구성원 리스트를 보여주는 테이블이 있다.<br>
페이지 당 10개의 item row를 보여주고 필터링이 가능한데<br>
10개의 row는 필터링된 구성원 리스트 TODO:</p>
<pre><code>import React from 'react';
import { FormattedMessage, useIntl } from 'react-intl';
import { useHistory, useParams } from 'react-router-dom';
import { useDebounce, useSearchParam } from 'react-use';
import { AttendanceStatus } from '@elice/openapi-client-attendance';
import { AttendanceGetSortByEnum } from '@elice/openapi-client-attendance';
import {
  ArrowBackIos as IconArrowBackIos,
  ArrowForwardIos as IconArrowForwardIos,
  DateRangeRounded as IconDateRange,
  Delete as IconDelete,
  Edit as IconEdit,
  FileDownload as IconFileDownload,
  Person as IconPerson,
  Search as IconSearch,
} from '@mui/icons-material';
import {
  Breadcrumbs,
  Button,
  IconButton,
  InputAdornment,
  Link,
  Paper,
  Stack,
  TextField,
  Typography,
} from '@mui/material';
import { LocalizationProvider } from '@mui/x-date-pickers';
import { AdapterDayjs } from '@mui/x-date-pickers/AdapterDayjs';
import { DatePicker } from '@mui/x-date-pickers/DatePicker';
import * as Sentry from '@sentry/react';
import { useQueryClient } from '@tanstack/react-query';
import dayjs from 'dayjs';
import { enqueueSnackbar } from 'notistack';
import queryString from 'query-string';

import { eliceAttendanceAttendanceBookApi } from 'src/api/clientAttendance';
import { ADMIN_ATTENDANCE_QUERY_KEYS } from '../ducks/hooks/constants';
import useAttendance from '../ducks/hooks/useAttendance';
import useAttendanceBook from '../ducks/hooks/useAttendanceBook';
import useAttendanceBookDownload from '../ducks/hooks/useAttendanceBookDownload';
import useAttendanceCount from '../ducks/hooks/useAttendanceCount';
import AttendanceBookFormModal from '../modals/AttendanceBookFormModal';
import ConfirmDialog from '../shared/ConfirmDialog';
import FilterToggleButtonGroup from '../shared/FilterToggleButtonGroup';
import AdminAttendanceDetailTable from './AdminAttendanceDetailTable';
import AttendanceInfo from './AttendanceInfo';

import type { AttendanceGetRequest } from '@elice/openapi-client-attendance';
import type { DateValidationError } from '@mui/x-date-pickers';
import type { PickerChangeHandlerContext } from '@mui/x-date-pickers/internals/hooks/usePicker/usePickerValue.types';
import type { Dayjs } from 'dayjs';

type ConfirmAttendanceDialog = {
  type: 'delete';
};

export type Order = 'asc' | 'desc';

export enum OrderBy {
  CheckIn = 'check_in',
  CheckOut = 'check_out',
  StaySeconds = 'stay_seconds',
  FaceDetectedSeconds = 'face_detection_seconds',
  FaceUndetectedSeconds = 'face_unrecognized_seconds',
}

const ROW_COUNT_PER_PAGE = 10;

const getSortBy = (orderBy: OrderBy | null, order: Order) => {
  switch (orderBy) {
    case OrderBy.CheckIn:
      if (order === 'asc') {
        return AttendanceGetSortByEnum.CheckInAsc;
      }
      return AttendanceGetSortByEnum.CheckInDesc;

    case OrderBy.CheckOut:
      if (order === 'asc') {
        return AttendanceGetSortByEnum.CheckOutAsc;
      }
      return AttendanceGetSortByEnum.CheckOutDesc;

    case OrderBy.FaceDetectedSeconds:
      if (order === 'asc') {
        return AttendanceGetSortByEnum.FaceDetectedSecondsAsc;
      }
      return AttendanceGetSortByEnum.FaceDetectedSecondsDesc;

    case OrderBy.FaceUndetectedSeconds:
      if (order === 'asc') {
        return AttendanceGetSortByEnum.FaceUndetectedSecondsAsc;
      }
      return AttendanceGetSortByEnum.FaceUndetectedSecondsDesc;

    case OrderBy.StaySeconds:
      if (order === 'asc') {
        return AttendanceGetSortByEnum.StaySecondsAsc;
      }
      return AttendanceGetSortByEnum.StaySecondsDesc;

    default:
      return undefined;
  }
};

const AdminAttendanceDetail = () => {
  const history = useHistory();
  const intl = useIntl();
  const queryClient = useQueryClient();
  const { attendanceBookId } = useParams&#x3C;{ attendanceBookId: string }>();

  const [isAttendanceBookEditModalOpened, setIsAttendanceBookEditModalOpened] =
    React.useState(false);

  const [searchQuery, setSearchQuery] = React.useState(
    useSearchParam('search') ?? ''
  );
  const [debouncedSearchQuery, setDebouncedSearchQuery] = React.useState(
    useSearchParam('search') ?? ''
  );
  const [isSearchQueryChanged, setIsSearchQueryChanged] = React.useState(false);
  const [page, setPage] = React.useState(Number(useSearchParam('page')) || 1);
  const [date, setDate] = React.useState&#x3C;Dayjs | null>(
    dayjs(useSearchParam('date') ?? undefined)
  );
  const [attendanceStatus, setAttendanceStatus] =
    React.useState&#x3C;AttendanceStatus | null>(null);

  // Table order state
  const [orderBy, setOrderBy] = React.useState&#x3C;OrderBy | null>(null);
  const [order, setOrder] = React.useState&#x3C;Order>('asc');

  const [confirmDialog, setConfirmDialog] =
    React.useState&#x3C;ConfirmAttendanceDialog | null>(null);

  // Put undefined if want to clear the query.
  const changeQueries = (queries: {
    [key: string]: string | number | undefined;
  }) => {
    history.replace({
      ...history.location,
      search: queryString.stringify({
        ...queryString.parse(history.location.search),
        ...queries,
      }),
    });
  };

  useDebounce(
    () => {
      // Prevent changes at initialization
      if (isSearchQueryChanged) {
        setDebouncedSearchQuery(searchQuery);
        setPage(1);

        if (searchQuery.length === 0) {
          changeQueries({ search: undefined, page: 1 });
        } else {
          changeQueries({ search: searchQuery, page: 1 });
        }
      }
    },
    250,
    [searchQuery]
  );

  const { download, isLoading: downloadLoading } = useAttendanceBookDownload({
    attendanceBookId,
    beginDate: date,
    endDate: date,
  });

  const { data: attendanceBookData } = useAttendanceBook(attendanceBookId);

  // Common params
  const attendanceParams: Omit&#x3C;AttendanceGetRequest, 'skip' | 'count'> = {
    filterSearch: debouncedSearchQuery
      ? `%${debouncedSearchQuery}%`
      : undefined,
    filterAttendanceBookId: attendanceBookId,
    filterDateGe: dayjs(date).format('YYYY-MM-DD'),
    filterDateLe: dayjs(date).format('YYYY-MM-DD'),
  };

  // Table row data
  const { data: attendanceData, isLoading: attendanceLoading } = useAttendance({
    ...attendanceParams,
    skip: (page - 1) * ROW_COUNT_PER_PAGE,
    count: ROW_COUNT_PER_PAGE,
    filterStatus: attendanceStatus ?? undefined,
    sortBy: getSortBy(orderBy, order),
  });

  // Count datas
  const { data: attendanceAllCountData } = useAttendanceCount(attendanceParams);
  const { data: attendanceAttendCompletedCountData } = useAttendanceCount({
    ...attendanceParams,
    filterStatus: AttendanceStatus.AttendCompleted,
  });
  const { data: attendanceAbsenceCountData } = useAttendanceCount({
    ...attendanceParams,
    filterStatus: AttendanceStatus.Absence,
  });
  const { data: attendanceAttendCountData } = useAttendanceCount({
    ...attendanceParams,
    filterStatus: AttendanceStatus.Attend,
  });
  const { data: attendanceLatenessCountData } = useAttendanceCount({
    ...attendanceParams,
    filterStatus: AttendanceStatus.Lateness,
  });
  const { data: attendanceOthersCountData } = useAttendanceCount({
    ...attendanceParams,
    filterStatus: AttendanceStatus.Others,
  });
  const { data: attendanceReadyCountData } = useAttendanceCount({
    ...attendanceParams,
    filterStatus: AttendanceStatus.Ready,
  });

  const refetch = () => {
    ADMIN_ATTENDANCE_QUERY_KEYS.forEach((queryKey) => {
      queryClient.invalidateQueries({
        queryKey: [queryKey],
      });
    });
  };

  const deleteAttendanceBook = async () => {
    closeConfirmDialog();
    try {
      await eliceAttendanceAttendanceBookApi.attendanceBookAttendanceBookIdDelete(
        {
          attendanceBookId,
        }
      );
      refetch();
      history.push(`/admin/attendances`);
    } catch (error) {
      Sentry.captureException(error);
      enqueueSnackbar(
        intl.formatMessage({ id: 'adminAttendance.error.default' }),
        {
          variant: 'error',
        }
      );
    }
  };

  const increaseDate = () => {
    if (date) {
      const addedDate = dayjs(date).add(1, 'day');
      setDate(addedDate);
      setPage(1);
      changeQueries({
        date: dayjs(addedDate).format('YYYY-MM-DD'),
        page: 1,
      });
    }
  };

  const decreaseDate = () => {
    if (date) {
      const subtractedDate = dayjs(date).subtract(1, 'day');
      setDate(subtractedDate);
      setPage(1);
      changeQueries({
        date: dayjs(subtractedDate).format('YYYY-MM-DD'),
        page: 1,
      });
    }
  };

  const getAttendanceCount = () => {
    switch (attendanceStatus) {
      // all
      case null:
        return attendanceAllCountData?.attendanceCount ?? 0;

      case AttendanceStatus.AttendCompleted:
        return attendanceAttendCompletedCountData?.attendanceCount ?? 0;

      case AttendanceStatus.Absence:
        return attendanceAbsenceCountData?.attendanceCount ?? 0;

      case AttendanceStatus.Attend:
        return attendanceAttendCountData?.attendanceCount ?? 0;

      case AttendanceStatus.Lateness:
        return attendanceLatenessCountData?.attendanceCount ?? 0;

      case AttendanceStatus.Others:
        return attendanceOthersCountData?.attendanceCount ?? 0;

      case AttendanceStatus.Ready:
        return attendanceReadyCountData?.attendanceCount ?? 0;
    }
  };

  const paginationCount = Math.ceil(getAttendanceCount() / ROW_COUNT_PER_PAGE);

  const getFilterOptionDescription = (count?: number) => {
    return typeof count === 'number'
      ? count +
          intl.formatMessage({
            id: 'adminAttendance.unit.person',
          })
      : '-';
  };

  const getMinDate = () => {
    if (!attendanceBookData) {
      return undefined;
    }

    return dayjs(attendanceBookData.openSchedule);
  };

  const getMaxDate = () => {
    if (!attendanceBookData) {
      return undefined;
    }

    const closeSchedule = dayjs(attendanceBookData.closeSchedule).startOf(
      'day'
    );
    const today = dayjs().startOf('day');

    if (closeSchedule.isBefore(today)) {
      return closeSchedule;
    }

    return today;
  };

  const getPreviousDateDisabled = () => {
    if (!attendanceBookData) {
      return true;
    }

    const openSchedule = dayjs(attendanceBookData.openSchedule).startOf('day');
    const dateWithoutTime = dayjs(date).startOf('day');

    if (
      dateWithoutTime.isSame(openSchedule) ||
      dateWithoutTime.isBefore(openSchedule)
    ) {
      return true;
    }

    return false;
  };

  const getNextDateDisabled = () => {
    if (!attendanceBookData) {
      return true;
    }

    const closeSchedule = dayjs(attendanceBookData.closeSchedule).startOf(
      'day'
    );
    const dateWithoutTime = dayjs(date).startOf('day');
    const today = dayjs().startOf('day');

    if (
      dateWithoutTime.isSame(closeSchedule) ||
      dateWithoutTime.isAfter(closeSchedule) ||
      dateWithoutTime.isSame(today) ||
      dateWithoutTime.isAfter(today)
    ) {
      return true;
    }

    return false;
  };

  const attendanceStatusOptions = [
    {
      value: '',
      title: intl.formatMessage({
        id: 'adminAttendance.detail.filter.attendanceStatus.all',
      }),
      description: getFilterOptionDescription(
        attendanceAllCountData?.attendanceCount
      ),
    },
    {
      value: AttendanceStatus.Attend,
      title: intl.formatMessage({
        id: 'adminAttendance.attendanceStatus.attend',
      }),
      description: getFilterOptionDescription(
        attendanceAttendCountData?.attendanceCount
      ),
    },
    {
      value: AttendanceStatus.Ready,
      title: intl.formatMessage({
        id: 'adminAttendance.attendanceStatus.ready',
      }),
      description: getFilterOptionDescription(
        attendanceReadyCountData?.attendanceCount
      ),
    },
    {
      value: AttendanceStatus.AttendCompleted,
      title: intl.formatMessage({
        id: 'adminAttendance.attendanceStatus.attendCompleted',
      }),
      description: getFilterOptionDescription(
        attendanceAttendCompletedCountData?.attendanceCount
      ),
    },
    {
      value: AttendanceStatus.Lateness,
      title: intl.formatMessage({
        id: 'adminAttendance.attendanceStatus.lateness',
      }),
      description: getFilterOptionDescription(
        attendanceLatenessCountData?.attendanceCount
      ),
    },
    {
      value: AttendanceStatus.Others,
      title: intl.formatMessage({
        id: 'adminAttendance.attendanceStatus.others',
      }),
      description: getFilterOptionDescription(
        attendanceOthersCountData?.attendanceCount
      ),
    },
    {
      value: AttendanceStatus.Absence,
      title: intl.formatMessage({
        id: 'adminAttendance.attendanceStatus.absence',
      }),
      description: getFilterOptionDescription(
        attendanceAbsenceCountData?.attendanceCount
      ),
    },
  ];

  const closeConfirmDialog = () => {
    setConfirmDialog(null);
  };

  const handleSearchChange = (event: React.ChangeEvent&#x3C;HTMLInputElement>) => {
    setIsSearchQueryChanged(true);
    setSearchQuery(event.target.value);
  };

  const handleDateChange: (
    value: dayjs.Dayjs | null,
    context: PickerChangeHandlerContext&#x3C;DateValidationError>
  ) => void = (value) => {
    if (value) {
      setDate(value);
      setPage(1);
      changeQueries({ date: value.format('YYYY-MM-DD'), page: 1 });
    }
  };

  const handleAttendanceEditButtonClick = () => {
    setIsAttendanceBookEditModalOpened(true);
  };

  const handleAttendanceDeleteButtonClick = () => {
    setConfirmDialog({
      type: 'delete',
    });
  };

  const handleFilterChange = (
    _: React.MouseEvent&#x3C;HTMLElement>,
    attendanceStatus: AttendanceStatus | ''
  ) => {
    setPage(1);
    changeQueries({ page: 1 });
    setAttendanceStatus(attendanceStatus || null);
  };

  const handlePageChange = (page: number) => {
    setPage(page);
    changeQueries({ page });
  };

  const handleOrderByChange = (requestedOrderBy: OrderBy) => {
    const isAsc = orderBy === requestedOrderBy &#x26;&#x26; order === 'asc';
    setOrder(isAsc ? 'desc' : 'asc');
    setOrderBy(requestedOrderBy);
  };

  const handleMemberManageButtonClick = () => {
    history.push(`/admin/attendances/${attendanceBookId}/users`);
  };

  return (
    &#x3C;>
      &#x3C;Paper elevation={0} sx={{ padding: '1.5rem', borderRadius: '1rem' }}>
        &#x3C;Stack spacing="1.5rem">
          {/* header */}
          &#x3C;Stack
            component="header"
            direction="row"
            gap="0.5rem"
            flexWrap="wrap"
            justifyContent="space-between"
          >
            &#x3C;Stack spacing="0.5rem">
              &#x3C;Breadcrumbs aria-label="breadcrumb">
                &#x3C;Link
                  underline="hover"
                  color="inherit"
                  onClick={() => history.push('/admin')}
                >
                  &#x3C;FormattedMessage id="adminAttendance.detail.breadcrumbs.organizationManagement" />
                &#x3C;/Link>
                &#x3C;Link
                  underline="hover"
                  color="inherit"
                  onClick={() => history.push('/admin/attendances')}
                >
                  &#x3C;FormattedMessage id="adminAttendance.detail.breadcrumbs.attendanceBook" />
                &#x3C;/Link>
                &#x3C;Typography color="text.primary" fontWeight={700}>
                  {attendanceBookData?.title ?? '-'}
                &#x3C;/Typography>
              &#x3C;/Breadcrumbs>
              &#x3C;Typography component="h2" variant="h6">
                {attendanceBookData?.title ?? '-'}
              &#x3C;/Typography>
            &#x3C;/Stack>
            &#x3C;Stack direction="row" gap="0.5rem" flexWrap="wrap">
              &#x3C;Button
                color="neutral"
                variant="contained"
                startIcon={&#x3C;IconDelete />}
                onClick={handleAttendanceDeleteButtonClick}
              >
                &#x3C;FormattedMessage id="adminAttendance.detail.buttons.deleteAttendanceBook" />
              &#x3C;/Button>
              &#x3C;Button
                color="neutral"
                variant="contained"
                startIcon={&#x3C;IconEdit />}
                onClick={handleAttendanceEditButtonClick}
              >
                &#x3C;FormattedMessage id="adminAttendance.detail.buttons.editAttendanceBook" />
              &#x3C;/Button>
            &#x3C;/Stack>
          &#x3C;/Stack>

          &#x3C;AttendanceInfo attendanceBookId={attendanceBookId} />

          &#x3C;Stack spacing="1rem">
            {/* toolbar */}
            &#x3C;Stack spacing="0.5rem">
              &#x3C;Typography
                component="h3"
                variant="body1"
                color={(theme) => theme.palette.text.secondary}
                fontWeight={700}
              >
                &#x3C;FormattedMessage id="adminAttendance.detail.subtitle.memberAttendanceStatus" />
              &#x3C;/Typography>

              &#x3C;Stack direction="row" flexWrap="wrap" gap="1rem">
                &#x3C;TextField
                  value={searchQuery}
                  onChange={handleSearchChange}
                  variant="outlined"
                  size="small"
                  placeholder={intl.formatMessage({
                    id: 'adminAttendance.detail.textField.search.placeholder',
                  })}
                  InputProps={{
                    endAdornment: (
                      &#x3C;InputAdornment position="end">
                        &#x3C;IconSearch />
                      &#x3C;/InputAdornment>
                    ),
                  }}
                  sx={{
                    '.MuiInputBase-root': {
                      width: '15.625rem',
                    },
                  }}
                />
                &#x3C;Stack direction="row" alignItems="center">
                  &#x3C;LocalizationProvider
                    dateAdapter={AdapterDayjs}
                    adapterLocale={intl.locale}
                  >
                    &#x3C;DatePicker
                      value={date}
                      onChange={handleDateChange}
                      slots={{ openPickerIcon: IconDateRange }}
                      slotProps={{
                        textField: {
                          required: true,
                          size: 'small',
                        },
                      }}
                      minDate={getMinDate()}
                      maxDate={getMaxDate()}
                      sx={{
                        marginRight: '0.5rem',
                      }}
                    />
                  &#x3C;/LocalizationProvider>
                  &#x3C;IconButton
                    sx={{ flexShrink: 0 }}
                    size="small"
                    disabled={getPreviousDateDisabled()}
                    onClick={decreaseDate}
                  >
                    &#x3C;IconArrowBackIos />
                  &#x3C;/IconButton>
                  &#x3C;IconButton
                    sx={{ flexShrink: 0 }}
                    size="small"
                    disabled={getNextDateDisabled()}
                    onClick={increaseDate}
                  >
                    &#x3C;IconArrowForwardIos />
                  &#x3C;/IconButton>
                &#x3C;/Stack>
                &#x3C;Stack
                  direction="row"
                  gap={1}
                  flexWrap="wrap"
                  sx={{ marginLeft: 'auto' }}
                >
                  &#x3C;Button
                    color="neutral"
                    startIcon={&#x3C;IconPerson />}
                    onClick={handleMemberManageButtonClick}
                  >
                    &#x3C;FormattedMessage id="adminAttendance.detail.buttons.memberManagement" />
                  &#x3C;/Button>
                  &#x3C;Button
                    startIcon={&#x3C;IconFileDownload />}
                    onClick={download}
                    disabled={downloadLoading}
                  >
                    &#x3C;FormattedMessage id="adminAttendance.detail.buttons.downloadAttendanceBook" />
                  &#x3C;/Button>
                &#x3C;/Stack>
              &#x3C;/Stack>
            &#x3C;/Stack>

            {/* attendance status filters */}
            &#x3C;FilterToggleButtonGroup
              value={attendanceStatus ?? ''}
              options={attendanceStatusOptions}
              onChange={handleFilterChange}
            />

            {/* table */}
            &#x3C;AdminAttendanceDetailTable
              rows={attendanceData}
              isLoading={attendanceLoading}
              isEmpty={
                attendanceData?.length === 0 &#x26;&#x26; !Boolean(debouncedSearchQuery)
              }
              isFaceDetection={attendanceBookData?.faceDetection.enabled}
              isSearchEmpty={
                attendanceData?.length === 0 &#x26;&#x26; Boolean(debouncedSearchQuery)
              }
              order={order}
              orderBy={orderBy}
              paginationCount={paginationCount}
              page={page}
              onPageChange={handlePageChange}
              onOrderByChange={handleOrderByChange}
            />
          &#x3C;/Stack>
        &#x3C;/Stack>
      &#x3C;/Paper>

      {/* modals */}

      &#x3C;AttendanceBookFormModal
        open={isAttendanceBookEditModalOpened}
        attendanceBookId={attendanceBookId}
        onCloseModal={() => setIsAttendanceBookEditModalOpened(false)}
      />

      {/* dialogs */}

      &#x3C;ConfirmDialog
        open={confirmDialog?.type === 'delete'}
        title={intl.formatMessage({
          id: 'adminAttendance.detail.confirmDialog.delete.title',
        })}
        description={intl.formatMessage({
          id: 'adminAttendance.detail.confirmDialog.delete.description',
        })}
        cancelLabel={intl.formatMessage({
          id: 'adminAttendance.detail.confirmDialog.delete.cancel',
        })}
        submitLabel={intl.formatMessage({
          id: 'adminAttendance.detail.confirmDialog.delete.submit',
        })}
        submitButtonColor="error"
        onClose={closeConfirmDialog}
        onSubmit={deleteAttendanceBook}
      />
    &#x3C;/>
  );
};

export default AdminAttendanceDetail;
</code></pre>
</section></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"metadata":{},"htmlContent":"\u003ch1\u003e출석부 개발\u003c/h1\u003e\n\u003cp\u003eadmin 개발은 이제 능숙하게 할 수 있고 이번에 출석부 admin 페이지를 새로 만들면서\u003cbr\u003e\n어떻게 코드를 작성했는지 정리해 두면 후배 개발자나 평가자들에게 도움이 될 것이라 생각한다.\u003cbr\u003e\n많은 페이지 중 출석부 상세 페이지 코드에 대해서 다루겠다.\u003cbr\u003e\n여러 출석부를 생성할 수 있고 출석부 리스트 페이지에서 각 아이템 링크로 접근할 수 있는 페이지다.\u003cbr\u003e\n모든 코드는 제일 아래쪽에서 볼 수 있다.\u003cbr\u003e\n위에서부터 아래로 내려가며 하나씩 설명해보겠다.\u003c/p\u003e\n\u003ch2\u003eHooks 순서\u003c/h2\u003e\n\u003ch3\u003eGlobal state\u003c/h3\u003e\n\u003cp\u003eAdminAttendanceDetail 컴포넌트 내부의 첫 번째 줄을 보면\u003cbr\u003e\n제일 먼저 어쩔 수 없이 넣어야 하는 hook을 두었다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ereact router 5의 history를 쓰기 위해서 useHistory()\u003c/li\u003e\n\u003cli\u003e다국어 지원을 위한 react intl의 intl을 쓰기 위해서 useIntl()\u003c/li\u003e\n\u003cli\u003eapi state를 관리해주는 tanstack qeury(react query)의 queryClient를 쓰기 위해서 useQueryClient()\u003c/li\u003e\n\u003cli\u003eurl의 query parameter를 가져오기 위해서 useParams()\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode\u003econst history = useHistory();\nconst intl = useIntl();\nconst queryClient = useQueryClient();\nconst { attendanceBookId } = useParams\u0026#x3C;{ attendanceBookId: string }\u003e();\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e마치 import 해오듯이 컴포넌트에서 필요한 variable을 가져오는 코드는 제일 위쪽에 두는 게 좋아보인다.\u003cbr\u003e\n다음으로 redux나 recoil 등의 global state를 두지만 여기서는 global state를 활용하지 않는다.\u003cbr\u003e\n사실 react query가 등장한 이후로 global state를 사용할일이 별로 없어진듯하다.\u003cbr\u003e\n만약 넣는다면 \u003ca href=\"https://redux-toolkit.js.org/tutorials/typescript#use-typed-hooks-in-components\"\u003e아래와 같은 코드\u003c/a\u003e를 넣었을 테다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003econst count = useAppSelector((state) =\u003e state.counter.value);\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eLocal State\u003c/h3\u003e\n\u003cp\u003e다음으로는 local state가 온다.\u003c/p\u003e\n\u003cp\u003e동료 개발자가 구현한 form 모달을 열고 닫을 수 있는 open state를 뒀다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003econst [isAttendanceBookEditModalOpened, setIsAttendanceBookEditModalOpened] =\n  React.useState(false);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e출석부 상세 페이지에는 출석부 구성원 리스트를 보여주는 테이블이 있다.\u003cbr\u003e\n페이지 당 10개의 item row를 보여주고 필터링이 가능한데\u003cbr\u003e\n10개의 row는 필터링된 구성원 리스트 TODO:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eimport React from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { useHistory, useParams } from 'react-router-dom';\nimport { useDebounce, useSearchParam } from 'react-use';\nimport { AttendanceStatus } from '@elice/openapi-client-attendance';\nimport { AttendanceGetSortByEnum } from '@elice/openapi-client-attendance';\nimport {\n  ArrowBackIos as IconArrowBackIos,\n  ArrowForwardIos as IconArrowForwardIos,\n  DateRangeRounded as IconDateRange,\n  Delete as IconDelete,\n  Edit as IconEdit,\n  FileDownload as IconFileDownload,\n  Person as IconPerson,\n  Search as IconSearch,\n} from '@mui/icons-material';\nimport {\n  Breadcrumbs,\n  Button,\n  IconButton,\n  InputAdornment,\n  Link,\n  Paper,\n  Stack,\n  TextField,\n  Typography,\n} from '@mui/material';\nimport { LocalizationProvider } from '@mui/x-date-pickers';\nimport { AdapterDayjs } from '@mui/x-date-pickers/AdapterDayjs';\nimport { DatePicker } from '@mui/x-date-pickers/DatePicker';\nimport * as Sentry from '@sentry/react';\nimport { useQueryClient } from '@tanstack/react-query';\nimport dayjs from 'dayjs';\nimport { enqueueSnackbar } from 'notistack';\nimport queryString from 'query-string';\n\nimport { eliceAttendanceAttendanceBookApi } from 'src/api/clientAttendance';\nimport { ADMIN_ATTENDANCE_QUERY_KEYS } from '../ducks/hooks/constants';\nimport useAttendance from '../ducks/hooks/useAttendance';\nimport useAttendanceBook from '../ducks/hooks/useAttendanceBook';\nimport useAttendanceBookDownload from '../ducks/hooks/useAttendanceBookDownload';\nimport useAttendanceCount from '../ducks/hooks/useAttendanceCount';\nimport AttendanceBookFormModal from '../modals/AttendanceBookFormModal';\nimport ConfirmDialog from '../shared/ConfirmDialog';\nimport FilterToggleButtonGroup from '../shared/FilterToggleButtonGroup';\nimport AdminAttendanceDetailTable from './AdminAttendanceDetailTable';\nimport AttendanceInfo from './AttendanceInfo';\n\nimport type { AttendanceGetRequest } from '@elice/openapi-client-attendance';\nimport type { DateValidationError } from '@mui/x-date-pickers';\nimport type { PickerChangeHandlerContext } from '@mui/x-date-pickers/internals/hooks/usePicker/usePickerValue.types';\nimport type { Dayjs } from 'dayjs';\n\ntype ConfirmAttendanceDialog = {\n  type: 'delete';\n};\n\nexport type Order = 'asc' | 'desc';\n\nexport enum OrderBy {\n  CheckIn = 'check_in',\n  CheckOut = 'check_out',\n  StaySeconds = 'stay_seconds',\n  FaceDetectedSeconds = 'face_detection_seconds',\n  FaceUndetectedSeconds = 'face_unrecognized_seconds',\n}\n\nconst ROW_COUNT_PER_PAGE = 10;\n\nconst getSortBy = (orderBy: OrderBy | null, order: Order) =\u003e {\n  switch (orderBy) {\n    case OrderBy.CheckIn:\n      if (order === 'asc') {\n        return AttendanceGetSortByEnum.CheckInAsc;\n      }\n      return AttendanceGetSortByEnum.CheckInDesc;\n\n    case OrderBy.CheckOut:\n      if (order === 'asc') {\n        return AttendanceGetSortByEnum.CheckOutAsc;\n      }\n      return AttendanceGetSortByEnum.CheckOutDesc;\n\n    case OrderBy.FaceDetectedSeconds:\n      if (order === 'asc') {\n        return AttendanceGetSortByEnum.FaceDetectedSecondsAsc;\n      }\n      return AttendanceGetSortByEnum.FaceDetectedSecondsDesc;\n\n    case OrderBy.FaceUndetectedSeconds:\n      if (order === 'asc') {\n        return AttendanceGetSortByEnum.FaceUndetectedSecondsAsc;\n      }\n      return AttendanceGetSortByEnum.FaceUndetectedSecondsDesc;\n\n    case OrderBy.StaySeconds:\n      if (order === 'asc') {\n        return AttendanceGetSortByEnum.StaySecondsAsc;\n      }\n      return AttendanceGetSortByEnum.StaySecondsDesc;\n\n    default:\n      return undefined;\n  }\n};\n\nconst AdminAttendanceDetail = () =\u003e {\n  const history = useHistory();\n  const intl = useIntl();\n  const queryClient = useQueryClient();\n  const { attendanceBookId } = useParams\u0026#x3C;{ attendanceBookId: string }\u003e();\n\n  const [isAttendanceBookEditModalOpened, setIsAttendanceBookEditModalOpened] =\n    React.useState(false);\n\n  const [searchQuery, setSearchQuery] = React.useState(\n    useSearchParam('search') ?? ''\n  );\n  const [debouncedSearchQuery, setDebouncedSearchQuery] = React.useState(\n    useSearchParam('search') ?? ''\n  );\n  const [isSearchQueryChanged, setIsSearchQueryChanged] = React.useState(false);\n  const [page, setPage] = React.useState(Number(useSearchParam('page')) || 1);\n  const [date, setDate] = React.useState\u0026#x3C;Dayjs | null\u003e(\n    dayjs(useSearchParam('date') ?? undefined)\n  );\n  const [attendanceStatus, setAttendanceStatus] =\n    React.useState\u0026#x3C;AttendanceStatus | null\u003e(null);\n\n  // Table order state\n  const [orderBy, setOrderBy] = React.useState\u0026#x3C;OrderBy | null\u003e(null);\n  const [order, setOrder] = React.useState\u0026#x3C;Order\u003e('asc');\n\n  const [confirmDialog, setConfirmDialog] =\n    React.useState\u0026#x3C;ConfirmAttendanceDialog | null\u003e(null);\n\n  // Put undefined if want to clear the query.\n  const changeQueries = (queries: {\n    [key: string]: string | number | undefined;\n  }) =\u003e {\n    history.replace({\n      ...history.location,\n      search: queryString.stringify({\n        ...queryString.parse(history.location.search),\n        ...queries,\n      }),\n    });\n  };\n\n  useDebounce(\n    () =\u003e {\n      // Prevent changes at initialization\n      if (isSearchQueryChanged) {\n        setDebouncedSearchQuery(searchQuery);\n        setPage(1);\n\n        if (searchQuery.length === 0) {\n          changeQueries({ search: undefined, page: 1 });\n        } else {\n          changeQueries({ search: searchQuery, page: 1 });\n        }\n      }\n    },\n    250,\n    [searchQuery]\n  );\n\n  const { download, isLoading: downloadLoading } = useAttendanceBookDownload({\n    attendanceBookId,\n    beginDate: date,\n    endDate: date,\n  });\n\n  const { data: attendanceBookData } = useAttendanceBook(attendanceBookId);\n\n  // Common params\n  const attendanceParams: Omit\u0026#x3C;AttendanceGetRequest, 'skip' | 'count'\u003e = {\n    filterSearch: debouncedSearchQuery\n      ? `%${debouncedSearchQuery}%`\n      : undefined,\n    filterAttendanceBookId: attendanceBookId,\n    filterDateGe: dayjs(date).format('YYYY-MM-DD'),\n    filterDateLe: dayjs(date).format('YYYY-MM-DD'),\n  };\n\n  // Table row data\n  const { data: attendanceData, isLoading: attendanceLoading } = useAttendance({\n    ...attendanceParams,\n    skip: (page - 1) * ROW_COUNT_PER_PAGE,\n    count: ROW_COUNT_PER_PAGE,\n    filterStatus: attendanceStatus ?? undefined,\n    sortBy: getSortBy(orderBy, order),\n  });\n\n  // Count datas\n  const { data: attendanceAllCountData } = useAttendanceCount(attendanceParams);\n  const { data: attendanceAttendCompletedCountData } = useAttendanceCount({\n    ...attendanceParams,\n    filterStatus: AttendanceStatus.AttendCompleted,\n  });\n  const { data: attendanceAbsenceCountData } = useAttendanceCount({\n    ...attendanceParams,\n    filterStatus: AttendanceStatus.Absence,\n  });\n  const { data: attendanceAttendCountData } = useAttendanceCount({\n    ...attendanceParams,\n    filterStatus: AttendanceStatus.Attend,\n  });\n  const { data: attendanceLatenessCountData } = useAttendanceCount({\n    ...attendanceParams,\n    filterStatus: AttendanceStatus.Lateness,\n  });\n  const { data: attendanceOthersCountData } = useAttendanceCount({\n    ...attendanceParams,\n    filterStatus: AttendanceStatus.Others,\n  });\n  const { data: attendanceReadyCountData } = useAttendanceCount({\n    ...attendanceParams,\n    filterStatus: AttendanceStatus.Ready,\n  });\n\n  const refetch = () =\u003e {\n    ADMIN_ATTENDANCE_QUERY_KEYS.forEach((queryKey) =\u003e {\n      queryClient.invalidateQueries({\n        queryKey: [queryKey],\n      });\n    });\n  };\n\n  const deleteAttendanceBook = async () =\u003e {\n    closeConfirmDialog();\n    try {\n      await eliceAttendanceAttendanceBookApi.attendanceBookAttendanceBookIdDelete(\n        {\n          attendanceBookId,\n        }\n      );\n      refetch();\n      history.push(`/admin/attendances`);\n    } catch (error) {\n      Sentry.captureException(error);\n      enqueueSnackbar(\n        intl.formatMessage({ id: 'adminAttendance.error.default' }),\n        {\n          variant: 'error',\n        }\n      );\n    }\n  };\n\n  const increaseDate = () =\u003e {\n    if (date) {\n      const addedDate = dayjs(date).add(1, 'day');\n      setDate(addedDate);\n      setPage(1);\n      changeQueries({\n        date: dayjs(addedDate).format('YYYY-MM-DD'),\n        page: 1,\n      });\n    }\n  };\n\n  const decreaseDate = () =\u003e {\n    if (date) {\n      const subtractedDate = dayjs(date).subtract(1, 'day');\n      setDate(subtractedDate);\n      setPage(1);\n      changeQueries({\n        date: dayjs(subtractedDate).format('YYYY-MM-DD'),\n        page: 1,\n      });\n    }\n  };\n\n  const getAttendanceCount = () =\u003e {\n    switch (attendanceStatus) {\n      // all\n      case null:\n        return attendanceAllCountData?.attendanceCount ?? 0;\n\n      case AttendanceStatus.AttendCompleted:\n        return attendanceAttendCompletedCountData?.attendanceCount ?? 0;\n\n      case AttendanceStatus.Absence:\n        return attendanceAbsenceCountData?.attendanceCount ?? 0;\n\n      case AttendanceStatus.Attend:\n        return attendanceAttendCountData?.attendanceCount ?? 0;\n\n      case AttendanceStatus.Lateness:\n        return attendanceLatenessCountData?.attendanceCount ?? 0;\n\n      case AttendanceStatus.Others:\n        return attendanceOthersCountData?.attendanceCount ?? 0;\n\n      case AttendanceStatus.Ready:\n        return attendanceReadyCountData?.attendanceCount ?? 0;\n    }\n  };\n\n  const paginationCount = Math.ceil(getAttendanceCount() / ROW_COUNT_PER_PAGE);\n\n  const getFilterOptionDescription = (count?: number) =\u003e {\n    return typeof count === 'number'\n      ? count +\n          intl.formatMessage({\n            id: 'adminAttendance.unit.person',\n          })\n      : '-';\n  };\n\n  const getMinDate = () =\u003e {\n    if (!attendanceBookData) {\n      return undefined;\n    }\n\n    return dayjs(attendanceBookData.openSchedule);\n  };\n\n  const getMaxDate = () =\u003e {\n    if (!attendanceBookData) {\n      return undefined;\n    }\n\n    const closeSchedule = dayjs(attendanceBookData.closeSchedule).startOf(\n      'day'\n    );\n    const today = dayjs().startOf('day');\n\n    if (closeSchedule.isBefore(today)) {\n      return closeSchedule;\n    }\n\n    return today;\n  };\n\n  const getPreviousDateDisabled = () =\u003e {\n    if (!attendanceBookData) {\n      return true;\n    }\n\n    const openSchedule = dayjs(attendanceBookData.openSchedule).startOf('day');\n    const dateWithoutTime = dayjs(date).startOf('day');\n\n    if (\n      dateWithoutTime.isSame(openSchedule) ||\n      dateWithoutTime.isBefore(openSchedule)\n    ) {\n      return true;\n    }\n\n    return false;\n  };\n\n  const getNextDateDisabled = () =\u003e {\n    if (!attendanceBookData) {\n      return true;\n    }\n\n    const closeSchedule = dayjs(attendanceBookData.closeSchedule).startOf(\n      'day'\n    );\n    const dateWithoutTime = dayjs(date).startOf('day');\n    const today = dayjs().startOf('day');\n\n    if (\n      dateWithoutTime.isSame(closeSchedule) ||\n      dateWithoutTime.isAfter(closeSchedule) ||\n      dateWithoutTime.isSame(today) ||\n      dateWithoutTime.isAfter(today)\n    ) {\n      return true;\n    }\n\n    return false;\n  };\n\n  const attendanceStatusOptions = [\n    {\n      value: '',\n      title: intl.formatMessage({\n        id: 'adminAttendance.detail.filter.attendanceStatus.all',\n      }),\n      description: getFilterOptionDescription(\n        attendanceAllCountData?.attendanceCount\n      ),\n    },\n    {\n      value: AttendanceStatus.Attend,\n      title: intl.formatMessage({\n        id: 'adminAttendance.attendanceStatus.attend',\n      }),\n      description: getFilterOptionDescription(\n        attendanceAttendCountData?.attendanceCount\n      ),\n    },\n    {\n      value: AttendanceStatus.Ready,\n      title: intl.formatMessage({\n        id: 'adminAttendance.attendanceStatus.ready',\n      }),\n      description: getFilterOptionDescription(\n        attendanceReadyCountData?.attendanceCount\n      ),\n    },\n    {\n      value: AttendanceStatus.AttendCompleted,\n      title: intl.formatMessage({\n        id: 'adminAttendance.attendanceStatus.attendCompleted',\n      }),\n      description: getFilterOptionDescription(\n        attendanceAttendCompletedCountData?.attendanceCount\n      ),\n    },\n    {\n      value: AttendanceStatus.Lateness,\n      title: intl.formatMessage({\n        id: 'adminAttendance.attendanceStatus.lateness',\n      }),\n      description: getFilterOptionDescription(\n        attendanceLatenessCountData?.attendanceCount\n      ),\n    },\n    {\n      value: AttendanceStatus.Others,\n      title: intl.formatMessage({\n        id: 'adminAttendance.attendanceStatus.others',\n      }),\n      description: getFilterOptionDescription(\n        attendanceOthersCountData?.attendanceCount\n      ),\n    },\n    {\n      value: AttendanceStatus.Absence,\n      title: intl.formatMessage({\n        id: 'adminAttendance.attendanceStatus.absence',\n      }),\n      description: getFilterOptionDescription(\n        attendanceAbsenceCountData?.attendanceCount\n      ),\n    },\n  ];\n\n  const closeConfirmDialog = () =\u003e {\n    setConfirmDialog(null);\n  };\n\n  const handleSearchChange = (event: React.ChangeEvent\u0026#x3C;HTMLInputElement\u003e) =\u003e {\n    setIsSearchQueryChanged(true);\n    setSearchQuery(event.target.value);\n  };\n\n  const handleDateChange: (\n    value: dayjs.Dayjs | null,\n    context: PickerChangeHandlerContext\u0026#x3C;DateValidationError\u003e\n  ) =\u003e void = (value) =\u003e {\n    if (value) {\n      setDate(value);\n      setPage(1);\n      changeQueries({ date: value.format('YYYY-MM-DD'), page: 1 });\n    }\n  };\n\n  const handleAttendanceEditButtonClick = () =\u003e {\n    setIsAttendanceBookEditModalOpened(true);\n  };\n\n  const handleAttendanceDeleteButtonClick = () =\u003e {\n    setConfirmDialog({\n      type: 'delete',\n    });\n  };\n\n  const handleFilterChange = (\n    _: React.MouseEvent\u0026#x3C;HTMLElement\u003e,\n    attendanceStatus: AttendanceStatus | ''\n  ) =\u003e {\n    setPage(1);\n    changeQueries({ page: 1 });\n    setAttendanceStatus(attendanceStatus || null);\n  };\n\n  const handlePageChange = (page: number) =\u003e {\n    setPage(page);\n    changeQueries({ page });\n  };\n\n  const handleOrderByChange = (requestedOrderBy: OrderBy) =\u003e {\n    const isAsc = orderBy === requestedOrderBy \u0026#x26;\u0026#x26; order === 'asc';\n    setOrder(isAsc ? 'desc' : 'asc');\n    setOrderBy(requestedOrderBy);\n  };\n\n  const handleMemberManageButtonClick = () =\u003e {\n    history.push(`/admin/attendances/${attendanceBookId}/users`);\n  };\n\n  return (\n    \u0026#x3C;\u003e\n      \u0026#x3C;Paper elevation={0} sx={{ padding: '1.5rem', borderRadius: '1rem' }}\u003e\n        \u0026#x3C;Stack spacing=\"1.5rem\"\u003e\n          {/* header */}\n          \u0026#x3C;Stack\n            component=\"header\"\n            direction=\"row\"\n            gap=\"0.5rem\"\n            flexWrap=\"wrap\"\n            justifyContent=\"space-between\"\n          \u003e\n            \u0026#x3C;Stack spacing=\"0.5rem\"\u003e\n              \u0026#x3C;Breadcrumbs aria-label=\"breadcrumb\"\u003e\n                \u0026#x3C;Link\n                  underline=\"hover\"\n                  color=\"inherit\"\n                  onClick={() =\u003e history.push('/admin')}\n                \u003e\n                  \u0026#x3C;FormattedMessage id=\"adminAttendance.detail.breadcrumbs.organizationManagement\" /\u003e\n                \u0026#x3C;/Link\u003e\n                \u0026#x3C;Link\n                  underline=\"hover\"\n                  color=\"inherit\"\n                  onClick={() =\u003e history.push('/admin/attendances')}\n                \u003e\n                  \u0026#x3C;FormattedMessage id=\"adminAttendance.detail.breadcrumbs.attendanceBook\" /\u003e\n                \u0026#x3C;/Link\u003e\n                \u0026#x3C;Typography color=\"text.primary\" fontWeight={700}\u003e\n                  {attendanceBookData?.title ?? '-'}\n                \u0026#x3C;/Typography\u003e\n              \u0026#x3C;/Breadcrumbs\u003e\n              \u0026#x3C;Typography component=\"h2\" variant=\"h6\"\u003e\n                {attendanceBookData?.title ?? '-'}\n              \u0026#x3C;/Typography\u003e\n            \u0026#x3C;/Stack\u003e\n            \u0026#x3C;Stack direction=\"row\" gap=\"0.5rem\" flexWrap=\"wrap\"\u003e\n              \u0026#x3C;Button\n                color=\"neutral\"\n                variant=\"contained\"\n                startIcon={\u0026#x3C;IconDelete /\u003e}\n                onClick={handleAttendanceDeleteButtonClick}\n              \u003e\n                \u0026#x3C;FormattedMessage id=\"adminAttendance.detail.buttons.deleteAttendanceBook\" /\u003e\n              \u0026#x3C;/Button\u003e\n              \u0026#x3C;Button\n                color=\"neutral\"\n                variant=\"contained\"\n                startIcon={\u0026#x3C;IconEdit /\u003e}\n                onClick={handleAttendanceEditButtonClick}\n              \u003e\n                \u0026#x3C;FormattedMessage id=\"adminAttendance.detail.buttons.editAttendanceBook\" /\u003e\n              \u0026#x3C;/Button\u003e\n            \u0026#x3C;/Stack\u003e\n          \u0026#x3C;/Stack\u003e\n\n          \u0026#x3C;AttendanceInfo attendanceBookId={attendanceBookId} /\u003e\n\n          \u0026#x3C;Stack spacing=\"1rem\"\u003e\n            {/* toolbar */}\n            \u0026#x3C;Stack spacing=\"0.5rem\"\u003e\n              \u0026#x3C;Typography\n                component=\"h3\"\n                variant=\"body1\"\n                color={(theme) =\u003e theme.palette.text.secondary}\n                fontWeight={700}\n              \u003e\n                \u0026#x3C;FormattedMessage id=\"adminAttendance.detail.subtitle.memberAttendanceStatus\" /\u003e\n              \u0026#x3C;/Typography\u003e\n\n              \u0026#x3C;Stack direction=\"row\" flexWrap=\"wrap\" gap=\"1rem\"\u003e\n                \u0026#x3C;TextField\n                  value={searchQuery}\n                  onChange={handleSearchChange}\n                  variant=\"outlined\"\n                  size=\"small\"\n                  placeholder={intl.formatMessage({\n                    id: 'adminAttendance.detail.textField.search.placeholder',\n                  })}\n                  InputProps={{\n                    endAdornment: (\n                      \u0026#x3C;InputAdornment position=\"end\"\u003e\n                        \u0026#x3C;IconSearch /\u003e\n                      \u0026#x3C;/InputAdornment\u003e\n                    ),\n                  }}\n                  sx={{\n                    '.MuiInputBase-root': {\n                      width: '15.625rem',\n                    },\n                  }}\n                /\u003e\n                \u0026#x3C;Stack direction=\"row\" alignItems=\"center\"\u003e\n                  \u0026#x3C;LocalizationProvider\n                    dateAdapter={AdapterDayjs}\n                    adapterLocale={intl.locale}\n                  \u003e\n                    \u0026#x3C;DatePicker\n                      value={date}\n                      onChange={handleDateChange}\n                      slots={{ openPickerIcon: IconDateRange }}\n                      slotProps={{\n                        textField: {\n                          required: true,\n                          size: 'small',\n                        },\n                      }}\n                      minDate={getMinDate()}\n                      maxDate={getMaxDate()}\n                      sx={{\n                        marginRight: '0.5rem',\n                      }}\n                    /\u003e\n                  \u0026#x3C;/LocalizationProvider\u003e\n                  \u0026#x3C;IconButton\n                    sx={{ flexShrink: 0 }}\n                    size=\"small\"\n                    disabled={getPreviousDateDisabled()}\n                    onClick={decreaseDate}\n                  \u003e\n                    \u0026#x3C;IconArrowBackIos /\u003e\n                  \u0026#x3C;/IconButton\u003e\n                  \u0026#x3C;IconButton\n                    sx={{ flexShrink: 0 }}\n                    size=\"small\"\n                    disabled={getNextDateDisabled()}\n                    onClick={increaseDate}\n                  \u003e\n                    \u0026#x3C;IconArrowForwardIos /\u003e\n                  \u0026#x3C;/IconButton\u003e\n                \u0026#x3C;/Stack\u003e\n                \u0026#x3C;Stack\n                  direction=\"row\"\n                  gap={1}\n                  flexWrap=\"wrap\"\n                  sx={{ marginLeft: 'auto' }}\n                \u003e\n                  \u0026#x3C;Button\n                    color=\"neutral\"\n                    startIcon={\u0026#x3C;IconPerson /\u003e}\n                    onClick={handleMemberManageButtonClick}\n                  \u003e\n                    \u0026#x3C;FormattedMessage id=\"adminAttendance.detail.buttons.memberManagement\" /\u003e\n                  \u0026#x3C;/Button\u003e\n                  \u0026#x3C;Button\n                    startIcon={\u0026#x3C;IconFileDownload /\u003e}\n                    onClick={download}\n                    disabled={downloadLoading}\n                  \u003e\n                    \u0026#x3C;FormattedMessage id=\"adminAttendance.detail.buttons.downloadAttendanceBook\" /\u003e\n                  \u0026#x3C;/Button\u003e\n                \u0026#x3C;/Stack\u003e\n              \u0026#x3C;/Stack\u003e\n            \u0026#x3C;/Stack\u003e\n\n            {/* attendance status filters */}\n            \u0026#x3C;FilterToggleButtonGroup\n              value={attendanceStatus ?? ''}\n              options={attendanceStatusOptions}\n              onChange={handleFilterChange}\n            /\u003e\n\n            {/* table */}\n            \u0026#x3C;AdminAttendanceDetailTable\n              rows={attendanceData}\n              isLoading={attendanceLoading}\n              isEmpty={\n                attendanceData?.length === 0 \u0026#x26;\u0026#x26; !Boolean(debouncedSearchQuery)\n              }\n              isFaceDetection={attendanceBookData?.faceDetection.enabled}\n              isSearchEmpty={\n                attendanceData?.length === 0 \u0026#x26;\u0026#x26; Boolean(debouncedSearchQuery)\n              }\n              order={order}\n              orderBy={orderBy}\n              paginationCount={paginationCount}\n              page={page}\n              onPageChange={handlePageChange}\n              onOrderByChange={handleOrderByChange}\n            /\u003e\n          \u0026#x3C;/Stack\u003e\n        \u0026#x3C;/Stack\u003e\n      \u0026#x3C;/Paper\u003e\n\n      {/* modals */}\n\n      \u0026#x3C;AttendanceBookFormModal\n        open={isAttendanceBookEditModalOpened}\n        attendanceBookId={attendanceBookId}\n        onCloseModal={() =\u003e setIsAttendanceBookEditModalOpened(false)}\n      /\u003e\n\n      {/* dialogs */}\n\n      \u0026#x3C;ConfirmDialog\n        open={confirmDialog?.type === 'delete'}\n        title={intl.formatMessage({\n          id: 'adminAttendance.detail.confirmDialog.delete.title',\n        })}\n        description={intl.formatMessage({\n          id: 'adminAttendance.detail.confirmDialog.delete.description',\n        })}\n        cancelLabel={intl.formatMessage({\n          id: 'adminAttendance.detail.confirmDialog.delete.cancel',\n        })}\n        submitLabel={intl.formatMessage({\n          id: 'adminAttendance.detail.confirmDialog.delete.submit',\n        })}\n        submitButtonColor=\"error\"\n        onClose={closeConfirmDialog}\n        onSubmit={deleteAttendanceBook}\n      /\u003e\n    \u0026#x3C;/\u003e\n  );\n};\n\nexport default AdminAttendanceDetail;\n\u003c/code\u003e\u003c/pre\u003e\n"},"__N_SSG":true},"page":"/blogs/[name]","query":{"name":"attendance-detail"},"buildId":"mO96hVcFmN38CsCcAxckd","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>